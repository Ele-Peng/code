<import src="../../components/prompt/prompt.wxml"/>
<import src="../../components/loading/loading.wxml"/>
<template is="loading" data= "{{ ...$wux.loading }}" />

<template is="dialog" data="{{ ...$wux.dialog }}"/>
<import src="../../components/dialog/dialog.wxml"/>

<title heading="{{heading}}" lastUrl="{{lastUrl}}">
</title>
<view class="page" style="width:750rpx;">
  <view class="page__bd">
    <view class="weui-tab">
      <block wx:if="{{role == 'm'}}" >
        <view class="weui-navbar" style="margin-top:128rpx;position:fixed;background-color:#fff;">
          <block wx:for-items="{{tabs}}" wx:key="{{ index }}">
            <view id="{{ index }}" class="weui-navbar__item {{ activeIndex == index ? 'weui-bar__item_on' : '' }}" bindtap="tabClick">
              <view class="weui-navbar__title">{{ item }}</view>
            </view>
          </block>
          <view class="weui-navbar__slider" style="left: {{ sliderLeft }}px; transform: translateX({{ sliderOffset }}px); -webkit-transform: translateX({{ sliderOffset }}px);"></view>
        </view>
        <view style="height:50px;" />
      </block>
      <view class="weui-tab__panel" style="padding-top:0;background:#FCFCFC;font-size:28rpx;">
        <view class="weui-tab__content" hidden="{{ activeIndex != 0 }}">
          <block wx:if="{{managers.length > 0}}">
            <view class="weui-cells__title" style='color:#A5A29F;margin-top:40rpx;'>管理员</view>
            <view class="weui-cells">
              <view wx:for="{{managers}}" wx:key="{{index}}" class="weui-cell weui-cell_input">
                <view class="weui-cell__hd">
                  <view class="weui-label" style='width:440rpx;'>{{item.user}}</view>
                </view>
                <view class="weui-cell__bd">
                </view>
                <view class="weui-cell__ft" style="margin: 5px 0; display:flex">
                <block wx:if="{{role == 'm' && item.user_id != my_user_id}}">
                  <button type="primary" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}" style="margin-right: 5px;background:#FF9906;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='changeUser'>修改</button>
                  <button type="warn" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}" style="margin-right: 5px;background:#FC5656;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='removeUser'>移除</button>
                </block>
                <view wx:else class="weui-input" />
                </view>
              </view>
            </view>
          </block>

          <block wx:if="{{designers.length > 0}}">
            <view class="weui-cells__title" style='color:#A5A29F;margin-top:40rpx;'>设计师</view>
            <view class="weui-cells">
                <view wx:for="{{designers}}" wx:key="{{index}}" class="weui-cell weui-cell_input">
                  <view class="weui-cell__hd">
                    <view class="weui-label" style='width:440rpx;'>{{item.user}}</view>
                  </view>
                  <view class="weui-cell__bd">
                </view>
                <view class="weui-cell__ft" style="margin: 5px 0; display:flex">
                <block wx:if="{{role == 'm' && item.user_id != my_user_id}}">
                  <button type="primary" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}" style="margin-right: 5px;background:#FF9906;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='changeUser'>修改</button>
                  <button type="warn" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}" style="margin-right: 5px;background:#FC5656;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='removeUser'>移除</button>
                </block>
                <view wx:else class="weui-input" />
                </view>
              </view>
            </view>
          </block>

          <block wx:if="{{purchasers.length > 0}}">
            <view class="weui-cells__title" style='color:#A5A29F;margin-top:40rpx;'>采购员</view>
            <view class="weui-cells">
                <view wx:for="{{purchasers}}" wx:key="{{index}}" class="weui-cell weui-cell_input">
                  <view class="weui-cell__hd">
                    <view class="weui-label" style='width:440rpx;'>{{item.user}}</view>
                  </view>
                  <view class="weui-cell__bd">
                </view>
                <view class="weui-cell__ft" style="margin: 5px 0; display:flex">
                <block wx:if="{{role == 'm' && item.user_id != my_user_id}}">
                  <button type="primary" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}"  style="margin-right: 5px;background:#FF9906;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='changeUser'>修改</button>
                  <button type="warn" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}" style="margin-right: 5px;background:#FC5656;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='removeUser'>移除</button>
                </block>
                <view wx:else class="weui-input" />
                </view>
              </view>
            </view>
          </block>
        </view>

        <view class="weui-tab__content" hidden="{{ activeIndex != 1 }}">
          <view class="weui-cells" wx:if="{{pendings.length > 0}}">
                <view wx:for="{{pendings}}" wx:key="{{index}}" class="weui-cell weui-cell_input">
                  <view class="weui-cell__hd">
                    <view class="weui-label" style="width:440rpx">{{item.user}}</view>
                  </view>
                  <view class="weui-cell__bd">
                </view>
                <view class="weui-cell__ft" style="margin: 5px 0; display:flex">
                <block wx:if="{{role == 'm' && item.user_id != my_user_id}}">
                  <button type="primary" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}"  style="margin-right: 5px;background:#FF9906;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='approveUser'>通过</button>
                  <button type="warn" class="weui-input btn-small weui-btn" data-user_id="{{item.user_id}}" data-name="{{item.user}}" style="margin-right: 5px;background:#FC5656;font-size: 24rpx;margin-top:12rpx;border-radius:5rpx;" bindtap='rejectUser'>拒绝</button>
                </block>
                <view wx:else class="weui-input" />
                </view>
              </view>
            </view>
        </view>
      </view>
    </view>
  </view>
</view>